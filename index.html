<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CANSLIM Resources</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Chivo+Mono:wght@500&display=swap');
        :root {
            --bg: #030712;
            --card: rgba(7, 11, 23, 0.88);
            --border: rgba(255, 255, 255, 0.08);
            --accent: #ff7ad9;
            --accent-2: #38bdf8;
            --accent-3: #a855f7;
            --text: #f8fbff;
            --subtext: #96a7c5;
        }
        *, *::before, *::after { box-sizing: border-box; }
        body {
            margin: 0;
            min-height: 100vh;
            font-family: 'Space Grotesk', 'Segoe UI', system-ui, sans-serif;
            background: radial-gradient(circle at 20% 15%, rgba(244,114,182,0.18), transparent 45%), radial-gradient(circle at 80% 0%, rgba(6,182,212,0.2), transparent 40%), var(--bg);
            color: var(--text);
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        h1, h2, h3 {
            font-weight: 600;
            line-height: 1.2;
            margin: 0;
        }
        a {
            color: var(--accent-2);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        a:hover {
            color: var(--accent);
        }
        .bg-aurora,
        .bg-grid {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
        }
        .bg-aurora {
            background: radial-gradient(circle at 15% 40%, rgba(236,72,153,0.22), transparent 45%), radial-gradient(circle at 80% 15%, rgba(6,182,212,0.25), transparent 55%), radial-gradient(circle at 55% 75%, rgba(139,92,246,0.18), transparent 60%);
            filter: blur(80px);
            animation: drift 18s ease-in-out infinite;
        }
        .bg-grid {
            background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 140px 140px;
            opacity: 0.25;
        }
        .hero,
        .reward-stage,
        .tabs,
        .content,
        .books-hero,
        footer {
            position: relative;
            z-index: 1;
        }
        .hero {
            padding: clamp(2rem, 5vw, 4.5rem) clamp(1.5rem, 6vw, 6rem) clamp(1rem, 4vw, 3rem);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: clamp(1.5rem, 4vw, 4rem);
        }
        .hero::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 28px;
            background: linear-gradient(135deg, rgba(15,23,42,0.75), rgba(7,11,23,0.9));
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 40px 120px rgba(2,6,23,0.8);
            z-index: -1;
        }
        .hero-left {
            display: flex;
            flex-direction: column;
            gap: 1.1rem;
        }
        .eyebrow {
            font-size: 0.85rem;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--accent-2);
        }
        .hero h1 {
            font-size: clamp(2.4rem, 6vw, 3.6rem);
        }
        .hero-subtext {
            color: var(--subtext);
            max-width: 520px;
        }
        .hero-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        .hero-primary,
        .hero-secondary {
            border-radius: 999px;
            padding: 0.85rem 1.8rem;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .hero-primary {
            background: linear-gradient(120deg, #f97316, #ec4899, #6366f1);
            color: #080b17;
            box-shadow: 0 20px 40px rgba(249,115,22,0.35);
        }
        .hero-secondary {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: var(--text);
        }
        .hero-primary:hover,
        .hero-secondary:hover {
            transform: translateY(-2px);
        }
        .hero-pulses {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .pulse-pill {
            border: 1px solid rgba(255,255,255,0.12);
            border-radius: 999px;
            padding: 0.35rem 1rem;
            font-size: 0.85rem;
            color: var(--subtext);
            background: rgba(15,23,42,0.7);
            backdrop-filter: blur(6px);
        }
        .hero-right {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 0.8rem;
        }
        .stat-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 1.1rem 1.3rem;
            box-shadow: 0 12px 40px rgba(3,7,18,0.7);
            position: relative;
            overflow: hidden;
        }
        .stat-card::after {
            content: '';
            position: absolute;
            inset: 10px auto auto 10px;
            width: 110px;
            height: 110px;
            background: radial-gradient(circle, rgba(236,72,153,0.35), transparent 60%);
            opacity: 0.4;
            pointer-events: none;
        }
        .stat-card.hero-card {
            grid-column: span 2;
        }
        .stat-label {
            font-size: 0.8rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--subtext);
        }
        .stat-value {
            font-size: clamp(2rem, 4vw, 3.4rem);
            font-weight: 700;
            color: #fff;
            margin: 0.1rem 0;
        }
        .stat-tag {
            font-size: 0.8rem;
            color: var(--accent-2);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        .stat-note {
            margin: 0;
            color: var(--subtext);
            font-size: 0.9rem;
        }
        .streak-card {
            background: linear-gradient(135deg, rgba(13,148,136,0.8), rgba(79,70,229,0.85));
            border-radius: 20px;
            padding: 1rem 1.3rem;
            min-height: 130px;
            box-shadow: 0 25px 45px rgba(79,70,229,0.45);
        }
        .streak-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.08em;
        }
        .streak-count {
            font-family: 'Chivo Mono', monospace;
            font-size: 1.4rem;
        }
        .xp-progress {
            margin-top: 0.85rem;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 999px;
            overflow: hidden;
        }
        .xp-progress-fill {
            width: 0%;
            height: 100%;
            border-radius: inherit;
            background: linear-gradient(90deg, #22d3ee, #f472b6, #a855f7);
            transition: width 0.4s ease;
        }
        .xp-label {
            margin: 0.6rem 0 0;
            font-size: 0.85rem;
            color: #fef3c7;
        }
        .reward-stage {
            padding: 0 clamp(1.5rem, 6vw, 6rem) clamp(2rem, 5vw, 4rem);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 2rem;
            align-items: center;
        }
        .reward-info h2 {
            font-size: clamp(1.6rem, 3vw, 2.4rem);
            margin-bottom: 0.5rem;
        }
        .reward-info p {
            color: var(--subtext);
        }
        .reward-track {
            position: relative;
            padding: 1.5rem 1rem;
            border-radius: 20px;
            background: rgba(7,11,23,0.85);
            border: 1px solid var(--border);
            display: flex;
            gap: clamp(0.8rem, 2vw, 1.5rem);
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .reward-track::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 1.2rem;
            right: 1.2rem;
            height: 2px;
            background: rgba(255,255,255,0.1);
            z-index: 0;
        }
        .reward-node {
            position: relative;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 18px;
            padding: 0.6rem 0.9rem;
            min-width: 130px;
            text-align: center;
            z-index: 1;
            transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
        }
        .reward-node .tier-name {
            font-weight: 600;
        }
        .reward-node small {
            display: block;
            font-size: 0.75rem;
            color: var(--subtext);
        }
        .reward-node.earned {
            border-color: var(--accent);
            box-shadow: 0 15px 30px rgba(236,72,153,0.25);
            transform: translateY(-4px);
            background: rgba(236,72,153,0.15);
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 12px clamp(1rem, 5vw, 3rem);
            background: rgba(2,6,23,0.9);
            backdrop-filter: blur(16px);
            position: sticky;
            top: 0;
            z-index: 10;
            border-top: 1px solid rgba(255,255,255,0.08);
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        .tab {
            padding: 0.75rem 1.4rem;
            border-radius: 999px;
            border: 1px solid rgba(255,255,255,0.08);
            color: var(--subtext);
            cursor: pointer;
            flex: 0 0 auto;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.85rem;
            transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
        }
        .tab.active {
            background: linear-gradient(120deg, #6366f1, #a855f7, #ec4899);
            color: #0b1120;
            border-color: transparent;
            box-shadow: 0 12px 25px rgba(99,102,241,0.4);
        }
        .tab:not(.active):hover {
            border-color: rgba(255,255,255,0.2);
            color: #fff;
        }
        .discord-link {
            margin-left: auto;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #fdf4ff;
        }
        .content {
            display: none;
            padding: clamp(1.5rem, 5vw, 3rem);
        }
        .content.active {
            display: block;
            background: rgba(10,16,35,0.85);
            margin: clamp(1rem, 4vw, 2.5rem) clamp(1rem, 6vw, 6rem);
            border-radius: 26px;
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 35px 75px rgba(1,5,15,0.7);
        }
        .content h2 {
            margin-top: 0;
        }
        ul, ol {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .link-list {
            list-style: decimal;
            padding-left: 1.5rem;
            color: var(--text);
        }
        .link-list li {
            margin-bottom: 0.9rem;
        }
        .link-title {
            font-weight: 600;
            color: #f4f4ff;
        }
        .link-url {
            font-size: 0.85rem;
            color: var(--subtext);
            word-break: break-all;
        }
        .gallery,
        .pdf-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
            gap: 1rem;
        }
        .gallery-item,
        .pdf-card,
        .media-card {
            background: rgba(7,11,23,0.8);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 18px;
            padding: 0.9rem;
            box-shadow: 0 18px 30px rgba(0,0,0,0.4);
        }
        .gallery-item {
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
        }
        .gallery-item img {
            border-radius: 14px;
            cursor: zoom-in;
        }
        .media-card {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .media-card h3 {
            margin: 0;
        }
        .media-caption {
            font-size: 0.9rem;
            color: var(--subtext);
        }
        .youtube-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.2rem;
        }
        iframe,
        .video-player {
            width: 100%;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.08);
            background: #000;
            aspect-ratio: 16 / 9;
        }
        video {
            background: #000;
        }
        .pdf-card {
            cursor: pointer;
            transition: transform 0.2s ease, border-color 0.2s ease;
        }
        .pdf-card:hover {
            transform: translateY(-4px);
            border-color: rgba(255,255,255,0.2);
        }
        .pdf-thumb {
            width: 100%;
            height: 220px;
            object-fit: cover;
            border-radius: 14px;
            background: linear-gradient(135deg,#1e293b,#0f172a);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .pdf-title {
            margin-top: 0.6rem;
            font-weight: 600;
        }
        .empty-state {
            color: var(--subtext);
            font-style: italic;
        }
        .books-hero {
            margin-top: 1.5rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
        }
        .books-hero img {
            width: 100%;
            border-radius: 18px;
            border: 2px solid rgba(255,255,255,0.08);
            box-shadow: 0 25px 40px rgba(0,0,0,0.55);
        }
        .books-link {
            font-weight: 600;
            color: #fb923c;
        }
        .support-modal {
            position: fixed;
            inset: 0;
            background: rgba(3,5,18,0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .support-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .support-card {
            background: linear-gradient(135deg, rgba(13,17,38,0.95), rgba(10,12,28,0.95));
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 24px;
            padding: 2rem;
            color: #fff;
            width: min(90vw, 420px);
            text-align: center;
            position: relative;
            box-shadow: 0 40px 65px rgba(0,0,0,0.65);
        }
        .support-card p {
            color: var(--subtext);
        }
        .support-cta {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 0.4rem;
            padding: 0.85rem 1.6rem;
            border-radius: 999px;
            background: linear-gradient(120deg,#fde047,#f97316);
            color: #3b1700;
            font-weight: 700;
            text-decoration: none;
            margin-top: 0.8rem;
        }
        .support-close {
            position: absolute;
            top: 12px;
            right: 12px;
            border: none;
            background: transparent;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
        }
        .page-loader {
            position: fixed;
            inset: 0;
            background: rgba(0,4,14,0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            z-index: 400;
            transition: opacity 0.3s ease;
        }
        .page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .page-loader .spinner {
            width: 62px;
            height: 62px;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.2);
            border-top-color: var(--accent);
            animation: spin 0.9s linear infinite;
        }
        .page-loader p {
            text-transform: uppercase;
            letter-spacing: 0.3em;
            font-size: 0.75rem;
            color: var(--subtext);
            text-align: center;
        }
        .lightbox {
            position: fixed;
            inset: 0;
            background: rgba(2,5,15,0.92);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: 1rem;
        }
        .lightbox.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .lightbox.hidden {
            display: none;
        }
        .lightbox-inner {
            background: #0f172a;
            border-radius: 20px;
            padding: 1rem;
            text-align: center;
            width: min(90vw, 900px);
        }
        .lightbox-inner img {
            max-width: 100%;
            border-radius: 16px;
        }
        .lightbox-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            border: none;
            background: rgba(0,0,0,0.4);
            color: #fff;
            font-size: 1.5rem;
            border-radius: 50%;
            cursor: pointer;
        }
        @keyframes drift {
            0% { transform: translate3d(-2%, 0, 0) scale(1); }
            50% { transform: translate3d(2%, 2%, 0) scale(1.05); }
            100% { transform: translate3d(-2%, 0, 0) scale(1); }
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        @media (max-width: 900px) {
            .tabs {
                justify-content: center;
                position: static;
            }
            .discord-link {
                margin-left: 0;
                order: 99;
            }
            .content.active {
                margin: 1rem;
            }
        }
        @media (max-width: 640px) {
            .hero::after {
                border-radius: 0;
            }
            .hero {
                padding: 1.5rem;
            }
            .reward-stage {
                padding: 1rem;
            }
            .tab {
                flex: 1 1 calc(50% - 10px);
                justify-content: center;
            }
        }
        @media (max-width: 480px) {
            .tab {
                flex-basis: 100%;
            }
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            .reward-track::before {
                display: none;
            }
            .reward-track {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-846VJ90DLC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-846VJ90DLC');
</script>
<body>
    <div class="bg-aurora" aria-hidden="true"></div>
    <div class="bg-grid" aria-hidden="true"></div>

    <header class="hero" id="hero">
        <div class="hero-left">
            <p class="eyebrow">CANSLIM vault</p>
            <h1>Stack energized research loops</h1>
            <p class="hero-subtext">
                Every link, screenshot, and PDF unlock keeps the crew energized. Enter the vault, chase the rush, and
                let the progress meters glow as you contribute.
            </p>
            <div class="hero-actions">
                <button type="button" class="hero-primary" onclick="jumpToSection('home')">Enter the vault</button>
                <a class="hero-secondary" href="http://ko-fi.com/ibd_canslim_investor_network/tiers" target="_blank"
                    rel="noopener noreferrer">Boost the drop</a>
            </div>
            <div class="hero-pulses">
                <span class="pulse-pill" id="pulse-links">0 drops logged</span>
                <span class="pulse-pill" id="pulse-visuals">0 visuals curated</span>
                <span class="pulse-pill" id="pulse-energy">0 XP surge</span>
            </div>
        </div>
        <div class="hero-right">
            <article class="stat-card hero-card">
                <p class="stat-label">Vault score</p>
                <p class="stat-value" id="stat-total">0</p>
                <p class="stat-note" id="reward-note">Collect 5 drops to unlock Scout tier.</p>
            </article>
            <div class="stats-grid" aria-live="polite">
                <article class="stat-card">
                    <p class="stat-label">PDF vault</p>
                    <p class="stat-value" id="stat-pdfs">0</p>
                    <span class="stat-tag">deep dives</span>
                </article>
                <article class="stat-card">
                    <p class="stat-label">Video training</p>
                    <p class="stat-value" id="stat-youtube">0</p>
                    <span class="stat-tag">yt drops</span>
                </article>
                <article class="stat-card">
                    <p class="stat-label">Visual cache</p>
                    <p class="stat-value" id="stat-visuals">0</p>
                    <span class="stat-tag">images + clips</span>
                </article>
                <article class="stat-card">
                    <p class="stat-label">Hype feed</p>
                    <p class="stat-value" id="stat-motivation">0</p>
                    <span class="stat-tag">motivation</span>
                </article>
            </div>
            <div class="streak-card">
                <div class="streak-label">
                    <span>Focus streak</span>
                    <span class="streak-count" id="streak-count">0d</span>
                </div>
                <div class="xp-progress">
                    <div class="xp-progress-fill" id="xp-progress-fill"></div>
                </div>
                <p class="xp-label" id="xp-progress-label">100 XP to next boost</p>
            </div>
        </div>
    </header>

    <section class="reward-stage" aria-label="Reward track">
        <div class="reward-info">
            <p class="eyebrow">tier momentum</p>
            <h2>Momentum milestones keep the grind fun</h2>
            <p>Feed the archive, watch the counter jump, and flex new tiers as soon as the community unlocks them.</p>
        </div>
        <div class="reward-track" role="list">
            <div class="reward-node earned" data-threshold="0" data-tier="Base Camp" role="listitem">
                <span class="tier-name">Base Camp</span>
                <small>0 drops</small>
            </div>
            <div class="reward-node" data-threshold="5" data-tier="Scout" role="listitem">
                <span class="tier-name">Scout</span>
                <small>5 drops</small>
            </div>
            <div class="reward-node" data-threshold="15" data-tier="Analyst" role="listitem">
                <span class="tier-name">Analyst</span>
                <small>15 drops</small>
            </div>
            <div class="reward-node" data-threshold="35" data-tier="Strategist" role="listitem">
                <span class="tier-name">Strategist</span>
                <small>35 drops</small>
            </div>
            <div class="reward-node" data-threshold="60" data-tier="Legend" role="listitem">
                <span class="tier-name">Legend</span>
                <small>60 drops</small>
            </div>
        </div>
    </section>

    <div id="page-loader" class="page-loader">
        <div class="spinner"></div>
        <p>Loading resources for better experience.<br>Thanks for your patience!</p>
    </div>
    <div class="tabs">
        <div class="tab active" data-tab="home" onclick="showTab(event, 'home')">Home</div>
        <div class="tab" data-tab="motivation" onclick="showTab(event, 'motivation')">Motivation</div>
        <div class="tab" data-tab="pdfs" onclick="showTab(event, 'pdfs')">PDFs</div>
        <div class="tab" data-tab="youtube" onclick="showTab(event, 'youtube')">YouTube</div>
        <div class="tab" data-tab="images" onclick="showTab(event, 'images')">Images</div>
        <div class="tab" data-tab="videos" onclick="showTab(event, 'videos')">Videos</div>
        <div class="tab" data-tab="books" onclick="showTab(event, 'books')">Books?</div>
        <a class="tab discord-link" href="https://discord.gg/xUz3nXZ3p5" target="_blank" rel="noopener noreferrer">
            <span>Discord</span>
        </a>
    </div>

    <div id="home" class="content active">
        <h2>Other Links</h2>
        <ol id="other-links" class="link-list"></ol>
    </div>

    <div id="motivation" class="content">
        <h2>Motivation</h2>
        <ol id="motivation-links" class="link-list"></ol>
    </div>

    <div id="pdfs" class="content">
        <h2>PDFs</h2>
        <div id="pdf-list" class="pdf-grid"></div>
    </div>

    <div id="youtube" class="content">
        <h2>YouTube Videos</h2>
        <div id="youtube-videos" class="youtube-grid"></div>
    </div>

    <div id="images" class="content">
        <h2>Images</h2>
        <div id="images-gallery" class="gallery"></div>
    </div>

    <div id="videos" class="content">
        <h2>Discord Videos</h2>
        <div id="videos-gallery" class="gallery"></div>
    </div>

    <div id="books" class="content">
        <h2>Support the community to gain access to the full CANSLIM books library.</h2>
        <p>
            Pitch in to keep the resource growing and unlock the curated bookshelf by backing us on
            <a class="books-link" href="http://ko-fi.com/ibd_canslim_investor_network/tiers" target="_blank" rel="noopener noreferrer">Ko-fi</a>.
        </p>
        <div class="books-hero">
            <img src="./library.png" alt="CANSLIM book list preview">
        </div>
    </div>

    <div id="support-modal" class="support-modal" aria-hidden="true">
        <div class="support-card">
            <button class="support-close" aria-label="Close support message">&times;</button>
            <h3>Support the CANSLIM Community</h3>
            <p>Help us maintain the research archive, book scans, and curated notes for fellow investors.</p>
            <a class="support-cta" href="http://ko-fi.com/ibd_canslim_investor_network/tiers" target="_blank" rel="noopener noreferrer">Back us on Ko-fi</a>
        </div>
    </div>

    <div id="image-lightbox" class="lightbox hidden">
        <div class="lightbox-overlay" data-lightbox-close></div>
        <div class="lightbox-inner">
            <button class="lightbox-close" aria-label="Close image preview" data-lightbox-close>&times;</button>
            <img id="lightbox-photo" src="" alt="Enlarged preview">
            <p id="lightbox-caption"></p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.js" integrity="sha512-O5bY5p+qZ+nhewc7ovQoPGwTpghSJOnA7xz/ES6sDIo8He3G6gZj/O9oYF6W1hLECPaKhLPgH8JbImTeTTKQ0g==" crossorigin="anonymous"></script>
    <script src="results-inline.js"></script>
    <script>
        const loaderElement = document.getElementById('page-loader');
        const rewardNodes = Array.from(document.querySelectorAll('.reward-track [data-threshold]')).sort((a, b) => {
            return Number(a.dataset.threshold || 0) - Number(b.dataset.threshold || 0);
        });
        const heroUi = {
            total: document.getElementById('stat-total'),
            pdfs: document.getElementById('stat-pdfs'),
            youtube: document.getElementById('stat-youtube'),
            visuals: document.getElementById('stat-visuals'),
            motivation: document.getElementById('stat-motivation'),
            streak: document.getElementById('streak-count'),
            rewardNote: document.getElementById('reward-note'),
            xpFill: document.getElementById('xp-progress-fill'),
            xpLabel: document.getElementById('xp-progress-label'),
            trackNodes: rewardNodes,
            pulseLinks: document.getElementById('pulse-links'),
            pulseVisuals: document.getElementById('pulse-visuals'),
            pulseEnergy: document.getElementById('pulse-energy')
        };
        const numberFormatter = new Intl.NumberFormat('en-US');
        const inlineResults = window.inlineScrapedResults || null;
        const scrapedDataPromise = loadScrapedData();

        const PDF_WORKER_SRC = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.worker.min.js';
        if (window.pdfjsLib && pdfjsLib.GlobalWorkerOptions) {
            pdfjsLib.GlobalWorkerOptions.workerSrc = PDF_WORKER_SRC;
        }

        const lightboxState = { container: null, image: null, caption: null };
        let supportTimer = null;
        const youtubeTitleCache = new Map();

        async function loadScrapedData() {
            if (window.scrapedData && Array.isArray(window.scrapedData.links)) {
                return window.scrapedData;
            }

            try {
                const response = await fetch('results.txt', { cache: 'no-store' });
                if (!response.ok) {
                    throw new Error(`Failed to fetch results.txt (${response.status})`);
                }
                const payload = await response.json();
                const normalized = normalizePayload(payload);
                window.scrapedData = normalized;
                return normalized;
            } catch (error) {
                if (inlineResults) {
                    console.warn('Falling back to inline results bundle.', error);
                    const normalized = normalizePayload(inlineResults);
                    window.scrapedData = normalized;
                    return normalized;
                }
                console.error('Unable to load results from results.txt', error);
                return getEmptyData();
            }
        }

        function normalizePayload(payload = {}) {
            const resource = payload.resource || {};
            const motivation = payload.motivation || {};

            return {
                links: resource.links || [],
                images: resource.images || [],
                videos: resource.videos || [],
                motivation: motivation.links || []
            };
        }

        function getEmptyData() {
            return { links: [], images: [], videos: [], motivation: [] };
        }

        document.addEventListener('DOMContentLoaded', () => {
            setupLightbox();
            scheduleSupportModal();
            showLoader();
            const dataLoad = scrapedDataPromise.then(populateDashboard);
            const minimumDelay = new Promise(resolve => setTimeout(resolve, 12000));
            Promise.allSettled([dataLoad, minimumDelay])
                .finally(() => hideLoader());
        });

        async function populateDashboard(data) {
            const safeData = data || { links: [], images: [], videos: [], motivation: [] };
            const uniqueImages = uniqueList(safeData.images);
            const uniqueVideos = uniqueList(safeData.videos);
            const { pdfLinks, youtubeVideos, otherLinks } = categorizeLinks(safeData.links);
            const motivationLinks = buildLinkItems(safeData.motivation);
            const imageItems = uniqueImages.map(src => ({ src, label: buildImageLabel(src) }));
            const videoItems = uniqueVideos.map(src => ({ src, label: buildMediaLabel(src) }));

            const heroSummary = {
                totalLinks: pdfLinks.length + youtubeVideos.length + otherLinks.length + motivationLinks.length,
                pdfs: pdfLinks.length,
                youtube: youtubeVideos.length,
                visuals: imageItems.length + videoItems.length,
                motivation: motivationLinks.length,
                mediaTotal: imageItems.length + videoItems.length
            };
            updateHeroStats(heroSummary);

            renderPdfGallery('pdf-list', pdfLinks, 'No PDFs available yet.');
            renderLinkList('other-links', otherLinks, 'No other links available yet.');
            renderLinkList('motivation-links', motivationLinks, 'No motivation links available yet.');
            await renderYoutubeVideos('youtube-videos', youtubeVideos, 'No YouTube videos found.');
            renderGallery('images-gallery', imageItems, 'image', 'No images to display.');
            renderGallery('videos-gallery', videoItems, 'video', 'No videos to display.');
        }

        function categorizeLinks(links = []) {
            const pdfLinks = [];
            const youtubeVideos = [];
            const otherLinks = [];
            const seen = new Set();

            (links || []).forEach(rawLink => {
                if (!rawLink) return;
                const link = rawLink.trim();
                if (!link || seen.has(link)) return;
                seen.add(link);

                if (isPdf(link)) {
                    pdfLinks.push({ url: link, label: buildDocumentLabel(link) });
                    return;
                }

                const youtubeId = extractYoutubeId(link);
                if (youtubeId) {
                    youtubeVideos.push({ url: link, id: youtubeId, label: buildYoutubeLabel(link, youtubeId) });
                    return;
                }

                otherLinks.push({ url: link, label: buildGenericLabel(link) });
            });

            return { pdfLinks, youtubeVideos, otherLinks };
        }

        function buildLinkItems(links = []) {
            const items = [];
            const seen = new Set();

            (links || []).forEach(rawLink => {
                if (!rawLink) return;
                const link = rawLink.trim();
                if (!link || seen.has(link)) return;
                seen.add(link);

                if (isPdf(link)) {
                    items.push({ url: link, label: buildDocumentLabel(link) });
                    return;
                }

                const youtubeId = extractYoutubeId(link);
                if (youtubeId) {
                    items.push({ url: link, label: buildYoutubeLabel(link, youtubeId) });
                    return;
                }

                items.push({ url: link, label: buildGenericLabel(link) });
            });

            return items;
        }

        function renderLinkList(containerId, items, emptyText) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';

            if (!items.length) {
                const li = document.createElement('li');
                li.className = 'empty-state';
                li.textContent = emptyText;
                container.appendChild(li);
                return;
            }

            const fragment = document.createDocumentFragment();
            items.forEach(item => {
                const li = document.createElement('li');
                const titleLink = document.createElement('a');
                titleLink.className = 'link-title';
                titleLink.href = item.url;
                titleLink.target = '_blank';
                titleLink.rel = 'noopener noreferrer';
                titleLink.textContent = item.label;

                const urlCopy = document.createElement('span');
                urlCopy.className = 'link-url';
                urlCopy.textContent = formatDisplayUrl(item.url);

                li.appendChild(titleLink);
                li.appendChild(urlCopy);
                fragment.appendChild(li);
            });
            container.appendChild(fragment);
        }

        function renderPdfGallery(containerId, pdfs, emptyText) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';

            if (!pdfs.length) {
                const msg = document.createElement('p');
                msg.className = 'empty-state';
                msg.textContent = emptyText;
                container.appendChild(msg);
                return;
            }

            const fragment = document.createDocumentFragment();
            pdfs.forEach(pdf => {
                const card = document.createElement('div');
                card.className = 'pdf-card';
                card.tabIndex = 0;

                const thumb = document.createElement('img');
                thumb.className = 'pdf-thumb';
                thumb.alt = `${pdf.label} preview`;
                thumb.src = createPdfPlaceholder(pdf.label);

                const title = document.createElement('div');
                title.className = 'pdf-title';
                title.textContent = pdf.label;

                card.appendChild(thumb);
                card.appendChild(title);
                card.addEventListener('click', () => window.open(pdf.url, '_blank', 'noopener'));
                card.addEventListener('keypress', event => {
                    if (event.key === 'Enter') {
                        window.open(pdf.url, '_blank', 'noopener');
                    }
                });

                fragment.appendChild(card);
                loadPdfThumbnail(pdf.url, thumb);
            });
            container.appendChild(fragment);
        }

        function renderYoutubeVideos(containerId, videos, emptyText) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';

            if (!videos.length) {
                const msg = document.createElement('p');
                msg.className = 'empty-state';
                msg.textContent = emptyText;
                container.appendChild(msg);
                return;
            }

            const fragment = document.createDocumentFragment();
            const pendingTitles = [];
            videos.forEach(video => {
                const wrapper = document.createElement('div');
                wrapper.className = 'media-card youtube-card';

                const heading = document.createElement('h3');
                heading.textContent = 'Loading title…';

                const iframe = document.createElement('iframe');
                iframe.src = `https://www.youtube-nocookie.com/embed/${video.id}?rel=0&modestbranding=1`;
                iframe.frameBorder = '0';
                iframe.allowFullscreen = true;
                iframe.setAttribute('loading', 'lazy');
                iframe.setAttribute('referrerpolicy', 'strict-origin-when-cross-origin');
                iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');

                const pending = fetchYoutubeTitle(video).then(title => {
                    heading.textContent = title;
                }).catch(() => {
                    heading.textContent = video.label || `YouTube Video (${video.id})`;
                });
                pendingTitles.push(pending);

                wrapper.appendChild(heading);
                wrapper.appendChild(iframe);
                fragment.appendChild(wrapper);
            });
            container.appendChild(fragment);
            return Promise.allSettled(pendingTitles);
        }

        function renderGallery(containerId, items, type, emptyText) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';

            if (!items.length) {
                const msg = document.createElement('p');
                msg.className = 'empty-state';
                msg.textContent = emptyText;
                container.appendChild(msg);
                return;
            }

            const fragment = document.createDocumentFragment();
            items.forEach(item => {
                const cell = document.createElement('div');
                cell.className = 'gallery-item';

                if (type === 'image') {
                    const img = document.createElement('img');
                    img.src = item.src;
                    img.alt = item.label || 'Discord image';
                    img.loading = 'lazy';
                    img.addEventListener('click', () => openLightbox(item.src, item.label));

                    cell.appendChild(img);
                } else {
                    const video = document.createElement('video');
                    video.className = 'video-player';
                    video.controls = true;
                    video.preload = 'metadata';
                    const source = document.createElement('source');
                    source.src = item.src;
                    source.type = guessMimeType(item.src);
                    video.appendChild(source);

                    const caption = document.createElement('p');
                    caption.className = 'media-caption';
                    caption.textContent = item.label;

                    const fallback = document.createElement('a');
                    fallback.href = item.src;
                    fallback.target = '_blank';
                    fallback.rel = 'noopener noreferrer';
                    fallback.textContent = 'Open video';

                    cell.appendChild(caption);
                    cell.appendChild(video);
                    cell.appendChild(fallback);
                }

                fragment.appendChild(cell);
            });
            container.appendChild(fragment);
        }

        function uniqueList(items = []) {
            return Array.from(new Set(items.map(item => item?.trim()).filter(Boolean)));
        }

        function isPdf(link) {
            return /\.pdf(\?|$)/i.test(link);
        }

        function extractYoutubeId(link) {
            try {
                const url = new URL(link);
                const host = url.hostname.replace(/^www\./, '');

                if (host === 'youtu.be') {
                    return url.pathname.replace('/', '');
                }

                if (host.endsWith('youtube.com')) {
                    if (url.pathname === '/watch') {
                        return url.searchParams.get('v');
                    }
                    if (url.pathname.startsWith('/live/')) {
                        return url.pathname.split('/')[2];
                    }
                    if (url.pathname.startsWith('/shorts/')) {
                        return url.pathname.split('/')[2];
                    }
                }
            } catch (error) {
                return null;
            }
            return null;
        }

        function buildDocumentLabel(link) {
            const name = extractLastSegment(link);
            return name || 'PDF Document';
        }

        function buildYoutubeLabel(link, fallbackId) {
            const name = extractLastSegment(link);
            return name || `YouTube Video (${fallbackId})`;
        }

        function buildGenericLabel(link) {
            try {
                const url = new URL(link);
                let path = url.pathname;
                if (path.length > 50) {
                    path = `${path.slice(0, 47)}...`;
                }
                return `${url.hostname}${path === '/' ? '' : path}`;
            } catch (error) {
                return link;
            }
        }

        function buildImageLabel(link) {
            const segment = extractLastSegment(link);
            return segment || getHostname(link) || 'Image';
        }

        function buildMediaLabel(link) {
            const host = getHostname(link);
            const segment = extractLastSegment(link);
            const isDiscordCdn = host?.includes('cdn.discordapp.com');
            if (segment && (!host || isDiscordCdn)) return segment;
            if (segment && host) return `${host} • ${segment}`;
            return segment || host || 'Video';
        }

        function getHostname(link) {
            try {
                const url = new URL(link);
                return url.hostname;
            } catch (error) {
                return '';
            }
        }

        function extractLastSegment(link) {
            try {
                const url = new URL(link);
                const segments = url.pathname.split('/').filter(Boolean);
                if (!segments.length) {
                    return url.hostname;
                }
                const lastSegment = decodeURIComponent(segments.pop());
                return lastSegment.replace(/\.[a-z0-9]+$/i, '').replace(/[-_]+/g, ' ').trim();
            } catch (error) {
                return link;
            }
        }

        function guessMimeType(src) {
            const ext = src.split('.').pop()?.split('?')[0]?.toLowerCase();
            if (ext === 'webm') return 'video/webm';
            return 'video/mp4';
        }

        function formatDisplayUrl(link) {
            try {
                const url = new URL(link);
                const path = url.pathname === '/' ? '' : url.pathname;
                const search = url.search || '';
                return `${url.hostname}${path}${search}`;
            } catch (error) {
                return link;
            }
        }

        function createPdfPlaceholder(label = 'PDF Document') {
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 520;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#eef2ff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#dbe4ff';
            ctx.fillRect(0, 0, canvas.width, 140);
            ctx.fillStyle = '#1d4ed8';
            ctx.font = 'bold 56px "Segoe UI", Arial';
            ctx.fillText('PDF', 140, 90);
            ctx.fillStyle = '#1f2937';
            ctx.font = '24px "Segoe UI", Arial';
            wrapText(ctx, label, 30, 200, 340, 30);
            return canvas.toDataURL('image/png');
        }

        async function loadPdfThumbnail(url, imgElement) {
            if (!window.pdfjsLib || !imgElement) return;
            const preview = await generatePdfThumbnail(url);
            if (preview) {
                imgElement.src = preview;
            }
        }

        async function generatePdfThumbnail(url) {
            if (!window.pdfjsLib) return null;
            try {
                const loadingTask = pdfjsLib.getDocument({ url, withCredentials: false });
                const pdf = await loadingTask.promise;
                const page = await pdf.getPage(1);
                const viewport = page.getViewport({ scale: 0.5 });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                await page.render({ canvasContext: context, viewport }).promise;
                const dataUrl = canvas.toDataURL('image/png');
                if (typeof pdf.cleanup === 'function') {
                    pdf.cleanup();
                }
                if (typeof pdf.destroy === 'function') {
                    pdf.destroy();
                }
                return dataUrl;
            } catch (error) {
                console.warn('Unable to generate PDF preview for', url, error);
                return null;
            }
        }

        function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
            const words = text.split(/\s+/);
            let line = '';
            words.forEach(word => {
                const testLine = `${line}${word} `;
                const { width } = ctx.measureText(testLine);
                if (width > maxWidth && line) {
                    ctx.fillText(line.trim(), x, y);
                    line = `${word} `;
                    y += lineHeight;
                } else {
                    line = testLine;
                }
            });
            if (line.trim()) {
                ctx.fillText(line.trim(), x, y);
            }
        }

        function setupLightbox() {
            const container = document.getElementById('image-lightbox');
            if (!container) return;
            lightboxState.container = container;
            lightboxState.image = document.getElementById('lightbox-photo');
            lightboxState.caption = document.getElementById('lightbox-caption');

            container.querySelectorAll('[data-lightbox-close]').forEach(element => {
                element.addEventListener('click', closeLightbox);
            });

            container.addEventListener('click', event => {
                if (event.target === container || event.target.classList.contains('lightbox-overlay')) {
                    closeLightbox();
                }
            });

            document.addEventListener('keydown', event => {
                if (event.key === 'Escape') {
                    closeLightbox();
                }
            });
        }

        function openLightbox(src, caption) {
            if (!lightboxState.container) {
                window.open(src, '_blank', 'noopener');
                return;
            }
            lightboxState.image.src = src;
            lightboxState.image.alt = caption || 'Image preview';
            lightboxState.caption.textContent = caption || '';
            lightboxState.container.classList.remove('hidden');
            requestAnimationFrame(() => lightboxState.container.classList.add('visible'));
        }

        function closeLightbox() {
            if (!lightboxState.container || lightboxState.container.classList.contains('hidden')) return;
            lightboxState.container.classList.remove('visible');
            setTimeout(() => {
                lightboxState.container.classList.add('hidden');
                lightboxState.image.src = '';
                lightboxState.caption.textContent = '';
            }, 200);
        }

        function scheduleSupportModal() {
            const modal = document.getElementById('support-modal');
            if (!modal) return;
            const closeBtn = modal.querySelector('.support-close');
            const hideModal = () => {
                modal.classList.remove('visible');
                modal.setAttribute('aria-hidden', 'true');
            };
            closeBtn?.addEventListener('click', hideModal);
            supportTimer = setTimeout(() => {
                modal.classList.add('visible');
                modal.setAttribute('aria-hidden', 'false');
            }, 45000);
        }

        function showLoader() {
            if (loaderElement) {
                loaderElement.classList.remove('hidden');
            }
        }

        function hideLoader() {
            if (loaderElement) {
                loaderElement.classList.add('hidden');
            }
        }

        function updateHeroStats(summary = {}) {
            if (!heroUi.total) return;
            const total = Math.max(0, summary.totalLinks || 0);
            animateCounter(heroUi.total, total);
            animateCounter(heroUi.pdfs, summary.pdfs || 0);
            animateCounter(heroUi.youtube, summary.youtube || 0);
            animateCounter(heroUi.visuals, summary.visuals || 0);
            animateCounter(heroUi.motivation, summary.motivation || 0);

            const streakValue = total === 0
                ? 0
                : Math.max(1, Math.min(99, Math.round(total / 4)));
            if (heroUi.streak) {
                heroUi.streak.textContent = `${streakValue}d`;
            }

            const visualsTotal = summary.mediaTotal ?? summary.visuals ?? 0;
            updateRewardTrack(total);
            updateXpMeter(total, visualsTotal);
            updatePulse(heroUi.pulseLinks, total, 'drops logged');
            updatePulse(heroUi.pulseVisuals, summary.visuals || 0, 'visuals curated');
            updatePulse(heroUi.pulseEnergy, computeXp(total, visualsTotal), 'XP surge');
        }

        function computeXp(total, mediaTotal) {
            return Math.max(0, (total * 9) + (mediaTotal * 5));
        }

        function updateRewardTrack(total) {
            if (!heroUi.trackNodes) return;
            let nextTier = null;
            heroUi.trackNodes.forEach(node => {
                const threshold = Number(node.dataset.threshold || 0);
                const earned = total >= threshold;
                node.classList.toggle('earned', earned);
                if (!earned && !nextTier) {
                    nextTier = { label: node.dataset.tier || 'Next tier', amount: threshold };
                }
            });
            updateRewardNote(total, nextTier);
        }

        function updateRewardNote(total, nextTier) {
            if (!heroUi.rewardNote) return;
            if (!nextTier) {
                heroUi.rewardNote.textContent = 'Legend tier reached. Keep compounding the edge.';
                return;
            }
            const diff = Math.max(1, nextTier.amount - total);
            heroUi.rewardNote.textContent = `${diff} more drops to hit ${nextTier.label}.`;
        }

        function updateXpMeter(total, mediaTotal) {
            if (!heroUi.xpFill) return;
            const xp = computeXp(total, mediaTotal);
            const percent = xp % 100;
            const normalized = xp === 0 ? 0 : (percent === 0 ? 100 : percent);
            heroUi.xpFill.style.width = `${normalized}%`;
            if (heroUi.xpLabel) {
                heroUi.xpLabel.textContent = normalized === 100
                    ? 'Bonus ready — drop another link.'
                    : `${100 - Math.round(normalized)} XP to next boost`;
            }
        }

        function updatePulse(element, value, label) {
            if (!element) return;
            const safe = Math.max(0, Math.floor(value || 0));
            element.textContent = `${numberFormatter.format(safe)} ${label}`;
        }

        function animateCounter(element, value) {
            if (!element) return;
            const target = Math.max(0, Math.floor(value || 0));
            const currentStored = Number(element.dataset.value || element.textContent.replace(/[^0-9]/g, '')) || 0;
            const duration = 600;
            if (currentStored === target) {
                element.textContent = numberFormatter.format(target);
                element.dataset.value = target;
                return;
            }
            const startTime = performance.now();
            const step = (now) => {
                const progress = Math.min(1, (now - startTime) / duration);
                const currentValue = Math.round(currentStored + (target - currentStored) * progress);
                element.textContent = numberFormatter.format(currentValue);
                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    element.dataset.value = target;
                }
            };
            requestAnimationFrame(step);
        }

        function showTab(event, tabId) {
            document.querySelectorAll('.content').forEach(section => section.classList.remove('active'));
            const activeSection = document.getElementById(tabId);
            if (activeSection) {
                activeSection.classList.add('active');
            }
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            const trigger = event?.currentTarget || document.querySelector(`.tab[data-tab="${tabId}"]`);
            trigger?.classList.add('active');
        }

        function jumpToSection(tabId) {
            const trigger = document.querySelector(`.tab[data-tab="${tabId}"]`);
            trigger?.click();
            const section = document.getElementById(tabId);
            section?.scrollIntoView({ behavior: 'smooth' });
            trigger?.scrollIntoView({ behavior: 'smooth', inline: 'center' });
        }

        async function fetchYoutubeTitle(video) {
            const cacheKey = video.id;
            if (youtubeTitleCache.has(cacheKey)) {
                return youtubeTitleCache.get(cacheKey);
            }

            const targetUrl = video.url && video.url.includes('youtube')
                ? video.url
                : `https://www.youtube.com/watch?v=${video.id}`;
            const endpoint = `https://noembed.com/embed?url=${encodeURIComponent(targetUrl)}`;

            try {
                const response = await fetch(endpoint);
                if (!response.ok) throw new Error('NoEmbed failed');
                const data = await response.json();
                const title = data.title || video.label || `YouTube Video (${video.id})`;
                youtubeTitleCache.set(cacheKey, title);
                return title;
            } catch (error) {
                const fallback = video.label || `YouTube Video (${video.id})`;
                youtubeTitleCache.set(cacheKey, fallback);
                return fallback;
            }
        }
    </script>
</body>
</html>
